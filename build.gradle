/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
plugins {
    id "java-library"
    id "dev.clojurephant.clojure" version "0.5.0"
    id 'com.google.cloud.tools.jib' version '2.1.0'
    id "io.spring.dependency-management" version "1.0.6.RELEASE"
}

ext {
    h2Version = "1.4.200"
    owlVersion = "5.1.13"
    junitJupiterVersion = "5.6.2"
    jenaVersion = "3.14.0"
    slf4jVersion = "1.7.30"
    caffeineVersion = "2.8.1"
    checkerVersion = "3.3.0"
    commonsLangVersion = "3.10"
    esriVersion = '2.2.3'
    jtsVersion = "1.16.1"
    geotoolsVersion = "22.2"
    jacksonVersion = "2.10.3"
    guavaVersion = "29.0-jre"
    guiceVersion = "4.2.3"
    rdf4jVersion = "3.1.3"
    metricsVersion = "4.1.5"
    postgresVersion = '42.2.12'
}

allprojects {
    repositories {
        // This needs to go first, in order to get the jai core jars, which jcenter doesn't have.
        maven { url "https://repo.osgeo.org/repository/release/" }
        jcenter()
        maven { url "https://clojars.org/repo" }
        maven { url "https://jitpack.io" }
    }

    // val isRelease = !version.toString().endsWith("SNAPSHOT")

}

subprojects {

    group = "com.nickrobison.trestle"
    version = "0.9.2-SNAPSHOT"
    apply plugin: 'java-library'
    apply plugin: "io.spring.dependency-management"

    dependencyManagement {
        dependencies {
            dependency group: 'commons-io', name: 'commons-io', version: '2.6'
            dependency group: 'me.tongfei', name: 'progressbar', version: '0.8.1'
        }
    }

    dependencies {
        // Dependencies
        compileOnly group: 'org.checkerframework', name: 'checker', version: checkerVersion
        implementation group: 'net.sourceforge.owlapi', name: 'owlapi-api', version: owlVersion
        implementation group: 'org.slf4j', name: 'slf4j-api', version: slf4jVersion
        implementation group: "com.typesafe", name: "config", version: "1.4.0"
        implementation(platform("com.fasterxml.jackson:jackson-bom:${jacksonVersion}"))
        implementation(platform("org.eclipse.rdf4j:rdf4j-bom:${rdf4jVersion}"))
        testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: junitJupiterVersion
        testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-params', version: junitJupiterVersion
        testRuntimeOnly group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: junitJupiterVersion
    }
    java {
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
        withJavadocJar()
        withSourcesJar()
    }

    tasks.withType(JavaCompile) {
        options.compilerArgs << '-parameters'
    }

    test {
        useJUnitPlatform()
    }
}